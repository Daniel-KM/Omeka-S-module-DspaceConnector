<?php
$this->headScript()->appendFile($this->assetUrl('js/dspace-connector.js', 'DspaceConnector'));
$this->headLink()->appendStylesheet($this->assetUrl('css/dspace-connector.css', 'DspaceConnector'));
$form->prepare(); 
$escapeHtml = $this->plugin('escapeHtml');
$formElement = $this->plugin('formElement');
$formLabel = $this->plugin('formLabel');
?>

<h1><?php echo $escapeHtml($this->translate('DSpace Connector')); ?></h1>

<?php if (isset($job)): ?>
<p>Importing <?php echo $collectionName; ?> in job <?php echo $job->getId(); ?></p>
<?php endif; ?>
<div id="import" class="section active">
    <?php echo $this->form()->openTag($form); ?>
    
    <?php $apiElement = $form->get('api_url'); ?>
    
    <?php echo $this->formField($apiElement) ; ?>
    <div id='actions'>
        <a class='button get-collections'>Get Collections</a>
        <a class='button get-communities'>Get Communities</a>
    </div>

    <?php echo $this->formElementErrors($apiElement, array('class' => 'messages')); ?>
    <?php echo $this->formField($form->get('ingest_files')); ?>
    <?php echo $formElement($form->get('csrf')); ?>
    
    <table id="collections">
        <tbody>
            <tr class="community template">
                <th class="name"></th>
                <th class="description"></th>
            </tr>
            
            <tr class="collection template">
                <td class="name">
                    <span class="name"></span>
                    <input type='hidden' name='collection_link' class='collection-link' value='' />
                    <input type='hidden' name='collection_name' class='collection-name' value='' />
                    <button class='import-collection'><?php echo $this->escapeHtml($this->translate('Import Collection')); ?></button>
                </td>
                <td class="description"></td>
            </tr>
        </tbody>
    </table>

    <?php echo $this->form()->closeTag(); ?>
</div>
