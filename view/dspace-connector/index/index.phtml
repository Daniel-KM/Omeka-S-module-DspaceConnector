<?php
$this->headScript()->appendFile($this->assetUrl('js/dspace-connector.js', 'DspaceConnector'));
$this->headLink()->appendStylesheet($this->assetUrl('css/dspace-connector.css', 'DspaceConnector'));
$form->prepare(); 
$escapeHtml = $this->plugin('escapeHtml');
$formElement = $this->plugin('formElement');
$formLabel = $this->plugin('formLabel');
$fetchUrl = $this->url('admin/dspace-connector/fetch',
                         array('controller' => 'index',  'action' => 'fetch'));
?>

<h1><?php echo $escapeHtml($this->translate('DSpace Connector')); ?></h1>

<div id="import" class="section active">
    <?php echo $this->form()->openTag($form); ?>
    
    <?php $apiElement = $form->get('api_url'); ?>
    
    <?php echo $this->formRow($apiElement) ; ?>
    <div id='actions'>
        <a class='button get-collections' data-fetch-url='<?php echo $fetchUrl; ?>'><?php echo $this->translate("Get Collections"); ?></a>
        <a class='button get-communities' data-fetch-url='<?php echo $fetchUrl; ?>'><?php echo $this->translate("Get Communities"); ?></a>
    </div>

    <?php echo $this->formElementErrors($apiElement, array('class' => 'messages')); ?>
    <?php echo $this->formRow($form->get('ingest_files')); ?>
    <?php echo $this->formRow($form->get('itemSet')); ?>
    <?php echo $this->formRow($form->get('comment')); ?>
    <?php echo $formElement($form->get('csrf')); ?>
    
    <table id="collections">
        <tbody>
            <tr class="community template">
                <th class="name"></th>
                <th class="description"></th>
            </tr>
            
            <tr class="collection template">
                <td class="name">
                    <button class='import-collection'><?php echo $this->escapeHtml($this->translate('Import Collection')); ?></button>
                    <span class="name"></span>
                    <input type='hidden' name='collection_link' class='collection-link' value='' />
                    <input type='hidden' name='collection_name' class='collection-name' value='' />
                    
                </td>
                <td class="description"></td>
            </tr>
        </tbody>
    </table>

    <?php echo $this->form()->closeTag(); ?>
</div>
